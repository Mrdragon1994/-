[toc]

# Chapter2 进程与线程

## 进程

- 程序是由指令和数据组成的,进程就是用来加载指令,管理内存,管理IO的;
- 当一个程序被运行,从磁盘上加载这个程序的代码到内存中,这就开启了一个进程;
- 进程可以看作一个程序的实例;大部分程序可以同时运行多个实例进程的(记事本);但有的程序只能启动一个进程(360);
- 进程是操作系统分配资源的最小单位.



## 线程

- 现在操作系统的基本调度单位已经不再是进程而是粒度更小的线程;当然,如果是操作系统线程,是可以单独分配资源的,如果是用户线程,则只能共享该线程获取到的资源；
- 一个线程就是一个指令流,将指令流中的一条条指令以一定的顺序交给CPU去执行;
- Java是单进程多线程;
- 在windows中进程是不活动的,仅仅是作为线程的容器;



## 二者的对比

- 进程基本上是相互独立的,而线程存在与进程内,是进程的一个子集;
- 进程拥有共享的资源,供其内部的线程共享;
- 进程间的通信较为复杂;而线程通信相对简单,因为他们共享内存,如:多个线程可以共享一个共享变量;
- 线程更为轻量,其上下文切换成本较进程低;



## 并行和并发

1. 单核CPU下,线程实际还是串行的,操作系统中的任务调度器会使用时间片轮转算法将CPU分配给不同的线程使用,只是由于CPU在线程间切换的非常快,我们是感知不到的,因此在单核CPU下总结为:微观串行,宏观并行;
2. 一般会将这种线程轮流使用CPU的做法就是并发(Concurrent);
3. 在多核CPU下,每个核心可以同时处理一个线程指令,故多个CPU同时执行多个线程的能力称为并行(parallel);
4. 实际上,并行和并发时同时存在的;



## 异步调用

1. 从方法调用的角度来讲:
- 如果需要等待结果返回,才能继续运行就是同步;
- 如果不需要等待结果返回,就能继续运行的时异步;
- PS:同步在多线程中还有一层意思,就是让多个线程步调一致;

2. 结论:
- 单核CPU,多线程不能实际提高程序运行效率;只是为了能够在不同的任务之间切换,不同线程轮流使用CPU,不至于一个线程总占用CPU;而使其他线程饥饿;
- 多核CPU可以并行多个线程,但能够提高程序的运行效率还是要情况的；
- IO操作不占用CPU,只是我们一般拷贝文件使用的是**阻塞IO**,这时相当于线程虽然不用CPU,但需要等待IO结束,没有充分利用线程;可用**非阻塞IO**和**异步IO**提升线程利用率.



